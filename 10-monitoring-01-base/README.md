# Домашнее задание к занятию "10.01. Зачем и что нужно мониторить"

## Обязательные задания

1. Вас пригласили настроить мониторинг на проект. На онбординге вам рассказали, что проект представляет из себя 
платформу для вычислений с выдачей текстовых отчетов, которые сохраняются на диск. Взаимодействие с платформой 
осуществляется по протоколу http. Также вам отметили, что вычисления загружают ЦПУ. Какой минимальный набор метрик вы
выведите в мониторинг и почему?

``` Средняя загрузка процессора за 5 минут - CPU LA;
Список процессов, которые загружают процессор; 
Процент свободного места оперативной памяти - RAM;
inodes - количество совбодных/занятых;
Количество времени, которое тратит процессор на работу в привилегированном режиме;
Время, котрое тратит процессор на выполнение кода приложения, а не системных функций;
Свободное место на жестком диске;
Нагрузка на сеть - количество подключений за 5 минут подключений;
Нагрузка на жесткий диск — количество операций на запись и чтение;
Количество задач, запущенных на исполнение;
Cкорость передачи и получения данных сетевым адаптером;
Допустимая полоса пропускания (в байтах в секунду) сетевого адаптера;
Среднее время (в секундах) операций чтения и записи;
Количество дисковых I/O операций, ожидающих обработки (в очереди);
Процент времени простаивания диска;
Мониторинг кэша - свободный кэш и количество подключенных клиентов;
Количество запросов к базе данных - 5 минут;
Скорость выполнения диском операций чтения и записи.

Данные метрики позволят нам комплексно подойти к мониторингу проекта и найти и устранить причины высокой загрузки ЦПУ.
Также данные метрики позволят 
```

2. Менеджер продукта посмотрев на ваши метрики сказал, что ему непонятно что такое RAM/inodes/CPUla. Также он сказал, 
что хочет понимать, насколько мы выполняем свои обязанности перед клиентами и какое качество обслуживания. Что вы 
можете ему предложить?

```commandline
Для этих целей нам необходимо будет ввести такие понятия как SLA, SLO и SLI — три аббревиатуры, 
которые представляют обещания, данные пользователям, внутренние цели, которые помогают 
выполнять обещания, и отслеживаемые показатели, позволяющие понять, как мы справляемся.

Цель этих трех компонентов — сформировать у всех (и поставщиков, и клиентов) 
общее представление о работе системы. Как часто будут доступны ваши системы? 
Как быстро отреагирует ваша команда на отказ системы? Какие обещания вы даете в 
отношении скорости и функциональных возможностей? Пользователи хотят это знать, поэтому вам нужны SLA, SLO и SLI.

SLA (соглашение об уровне обслуживания) — это соглашение между поставщиком и клиентом об измеримых показателях, 
таких как время безотказной работы, время реагирования, а также мерах ответственности.

Эти соглашения обычно составляются новыми юридическими и бизнес-командами компании. В них включаются обещания, 
которые вы даете клиентам, а также последствия, которые повлечет за собой невыполнение этих обещаний. Как правило, 
последствия включают в себя штрафы, компенсации или продление лицензий.

SLO (цель уровня обслуживания) — это соглашение в рамках SLA о конкретном показателе, 
например о времени безотказной работы или времени реагирования. Таким образом, если 
соглашение SLA является формальным соглашением между вами и клиентом, то SLO — это отдельные обещания, 
которые вы даете клиенту. Соглашения SLO формируют ожидания клиентов и показывают командам ИТ и DevOps, 
каких целей они должны достичь и на какие показатели ориентироваться.

Индикатор уровня обслуживания (SLI) измеряет соответствие цели уровня обслуживания (SLO). 
Например, если в SLA указано, что системы будут доступны 99,95 % времени, то в качестве SLO, 
вероятно, будет выбрано время безотказной работы 99,95 %, а в качестве SLI — фактическое 
измеренное время безотказной работы. Возможно, оно составит 99,96 %. Или 99,99 %. Чтобы 
удовлетворять требованиям SLA, индикатор SLI должен соответствовать обещаниям, 
зафиксированным в этом документе, или превосходить их.
```

3. Вашей DevOps команде в этом году не выделили финансирование на построение системы сбора логов. Разработчики в свою 
очередь хотят видеть все ошибки, которые выдают их приложения. Какое решение вы можете предпринять в этой ситуации, 
чтобы разработчики получали ошибки приложения?

```commandline
logstash
Это открытая система для сбора событий и логов, которая хорошо себя зарекомендовала в сообществе. 
Cо своей задачей logstash справляется: логи собираются, а поиск осуществляется через веб-интерфейс.

Fluentd
Standalone-решение. В отличие от logstash, 
которая написана на JRuby и поэтому требует JVM, она реализована на 
CRuby и критические по производительности участки написаны на C. Система опять же открытая и 
позволяет собирать большие потоки логов, 
используя более 1500 различных плагинов. Она хорошо документирована и предельно понятна.

Atatus — самый молодой инструмент; сервис запущен в 2014 году. Cам по себе инструмент 
 очень похож на New Relic, причем не только в возможностях (APM, Browser monitoring и т.п.), но и во внешнем виде.

Значительным же недостатком является поддержка лишь Node.js и PHP. С другой стороны, она реализована заметно лучше, 
чем у Datadog. 
В отличие от последнего, Atatus не требует от приложений доработок и выставления дополнительных меток в коде.
```

4. Вы, как опытный SRE, сделали мониторинг, куда вывели отображения выполнения SLA=99% по http кодам ответов. 
Вычисляете этот параметр по следующей формуле: summ_2xx_requests/summ_all_requests. Данный параметр не поднимается выше 
70%, но при этом в вашей системе нет кодов ответа 5xx и 4xx. Где у вас ошибка?

```commandline
SLI = (summ_2xx_requests + summ_3xx_requests) / (summ_all_requests)
```

## Дополнительное задание (со звездочкой*) - необязательно к выполнению

Вы устроились на работу в стартап. На данный момент у вас нет возможности развернуть полноценную систему 
мониторинга, и вы решили самостоятельно написать простой python3-скрипт для сбора основных метрик сервера. Вы, как 
опытный системный-администратор, знаете, что системная информация сервера лежит в директории `/proc`. 
Также, вы знаете, что в системе Linux есть  планировщик задач cron, который может запускать задачи по расписанию.

Суммировав все, вы спроектировали приложение, которое:
- является python3 скриптом
- собирает метрики из папки `/proc`
- складывает метрики в файл 'YY-MM-DD-awesome-monitoring.log' в директорию /var/log 
(YY - год, MM - месяц, DD - день)
- каждый сбор метрик складывается в виде json-строки, в виде:
  + timestamp (временная метка, int, unixtimestamp)
  + metric_1 (метрика 1)
  + metric_2 (метрика 2)
  
     ...
     
  + metric_N (метрика N)
  
- сбор метрик происходит каждую 1 минуту по cron-расписанию

Для успешного выполнения задания нужно привести:

а) работающий код python3-скрипта,

б) конфигурацию cron-расписания,

в) пример верно сформированного 'YY-MM-DD-awesome-monitoring.log', имеющий не менее 5 записей,

P.S.: количество собираемых метрик должно быть не менее 4-х.
P.P.S.: по желанию можно себя не ограничивать только сбором метрик из `/proc`.

---

### Как оформить ДЗ?

Выполненное домашнее задание пришлите ссылкой на .md-файл в вашем репозитории.

---
